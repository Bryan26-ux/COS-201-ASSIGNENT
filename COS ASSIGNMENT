#!/usr/bin/env python3
"""
Simple 2009 US federal income tax calculator.

Filing status:
0 - single
1 - married filing jointly or qualifying widow(er)
2 - married filing separately
3 - head of household

Usage: run the script and follow prompts.
"""

BRACKETS = {
    0: [(8350, 0.10), (33950, 0.15), (82250, 0.25), (171550, 0.28), (372950, 0.33), (float("inf"), 0.35)],  # single
    1: [(16700, 0.10), (67900, 0.15), (137050, 0.25), (208850, 0.28), (372950, 0.33), (float("inf"), 0.35)],  # married filing jointly
    2: [(8350, 0.10), (33950, 0.15), (68525, 0.25), (104425, 0.28), (186475, 0.33), (float("inf"), 0.35)],  # married filing separately
    3: [(11950, 0.10), (45500, 0.15), (117450, 0.25), (190200, 0.28), (372950, 0.33), (float("inf"), 0.35)],  # head of household
}


def compute_tax(status: int, income: float) -> float:
    """Compute tax for given filing status and taxable income using 2009 brackets."""
    if status not in BRACKETS:
        raise ValueError("Invalid filing status.")
    if income <= 0:
        return 0.0

    tax = 0.0
    prev_limit = 0.0
    for limit, rate in BRACKETS[status]:
        taxable = min(income, limit) - prev_limit
        if taxable > 0:
            tax += taxable * rate
        prev_limit = limit
        if income <= limit:
            break
    return tax


def main():
    print("2009 US Federal Income Tax Calculator")
    print("Enter filing status (0=single, 1=married filing jointly, 2=married filing separately, 3=head of household)")

    try:
        status_raw = input("Filing status (0-3): ").strip()
        status = int(status_raw)
    except ValueError:
        print("Invalid filing status. Please enter an integer 0,1,2 or 3.")
        return

    if status not in BRACKETS:
        print("Invalid filing status. Must be 0, 1, 2, or 3.")
        return

    try:
        income_raw = input("Taxable income (e.g. 10000.50): ").strip().replace(",", "")
        income = float(income_raw)
    except ValueError:
        print("Invalid income. Please enter a numeric value.")
        return

    if income < 0:
        print("Income cannot be negative.")
        return

    tax = compute_tax(status, income)
    print(f"Taxable income: ${income:,.2f}")
    print(f"Calculated tax: ${tax:,.2f}")


if __name__ == "__main__":
    main()
